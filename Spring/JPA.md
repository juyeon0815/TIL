# JPA

---

- Java Persistence API ( ìë°” ORM ê¸°ìˆ ì— ëŒ€í•œ API í‘œì¤€ ëª…ì„¸)
- ORMì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ëª¨ì•„ë‘” ê²ƒ



## ORMì´ë€?

- Object-relational mapping ( ê°ì²´ ê´€ê³„ ë§¤í•‘ )
- ê°ì²´ëŠ” ê°ì²´ëŒ€ë¡œ ì„¤ê³„ / ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŒ€ë¡œ ì„¤ê³„ â‡’ ORM í”„ë ˆì„ì›Œí¬ê°€ ì¤‘ê°„ì—ì„œ ë§¤í•‘



## JPA ë™ì‘ê³¼ì •

![STUN](/res/operationProcess.png)

JPAë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë˜ ê²½ìš° ğŸ‘‰ğŸ» JAVAì• í”Œë¦¬ì¼€ì´ì…˜ì´ JDBC APIë¥¼ ì‚¬ìš©í•´ DBì™€ í†µì‹ 

JPAë¥¼ ì‚¬ìš©í•œ ê²½ìš° ğŸ‘‰ğŸ» JPAë¥¼ í†µí•´ JDBC APIë¥¼ ì‚¬ìš©í•˜ì—¬ SQLì„ í†µí•´ DBì™€ í†µì‹ í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ë°˜í™˜



### - ì €ì¥

![STUN](/res/save.png)

ğŸ“Œ ë™ì‘ê³¼ì • (ğŸ‘‚ğŸ» JPAê°€  ìƒì†ê´€ê³„ ë“± ì•Œì•„ì„œ í•´ê²° )

1. DBì— ë„£ê³ ì‹¶ì€ Member ì •ë³´ë¥¼ MemberDAOì— ë‹´ê¸°
2. JPA ë©”ì†Œë“œ PERSIST í˜¸ì¶œ
3.  JPAê°€ Member Entityë¶„ì„ í›„ SQL ìƒì„±
4. JDBC APIë¥¼ ì‚¬ìš©í•˜ì—¬ DBì— INSERT QUERY ì „ë‹¬



### - ì¡°íšŒ

![stun](/res/inquiry.png)

ğŸ“Œ ë™ì‘ê³¼ì •

1. ê°ì²´ë¥¼ ë¶„ì„í•´ ì ì ˆí•œ SELECT SQL ìƒì„±
2. JDBC APIë¥¼ ì‚¬ìš©í•´ SQL ì „ë‹¬
3.  DBì—ì„œ ë°˜í™˜ëœ ê²°ê³¼ë¥¼ ResultSet ë§¤í•‘ì„ ì´ìš©í•´ ê°ì²´ë¡œ ë§Œë“¤ì–´ì„œ ë°˜í™˜



## ğŸ™„JPAë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ì´ìœ ?

- ìƒì‚°ì„± ( CRUD )

     - ì €ì¥ : DBì— ì €ì¥í•  ë•Œ, jap.persist(member)ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë„˜ê²¨ì£¼ë©´, db queryê°€ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì ¸ ë„˜ì–´ê°„ë‹¤.  = queryë¥¼ ì§¤ í•„ìš”ê°€ì—†ë‹¤! í˜¸ì¶œë§Œí•´ì„œ ì‚¬ìš©í•˜ë©´ ë!
     - ì¡°íšŒ : jpa.find(memberId)ë¥¼ í†µí•´ ê°ì²´ë§Œ ë„˜ê¸°ë©´ ì•Œì•„ì„œ ì¡°íšŒí•´ì¤€ë‹¤
     - ìˆ˜ì • : member.setName("ìˆ˜ì •í• ì´ë¦„") ë¥¼ í†µí•´ ìˆ˜ì •ê°€ëŠ¥
     - ì‚­ì œ : jpa.remove(member) 
     
     
     
- ìœ ì§€ë³´ìˆ˜ : JPA í•„ë“œë§Œ ì¶”ê°€í•˜ë©´ SQLì€ ì•Œì•„ì„œ JPAê°€ ì²˜ë¦¬

     - SQLë¬¸ì„ ê³ ì¹  í•„ìš”X -> ì•Œì•„ì„œ ì²˜ë¦¬O

     

- JPAì™€ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ í•´ê²°

     - ìƒì† 

     ![stun](/res/inheritance.png)

     1. ì €ì¥ : jpa.persist (Album);
         1. ê°ì²´ ë¶„í•´ ( Album ê°ì²´ëŠ” Item ì†ì„±ì„ ëª¨ë‘ ê°€ì§„ë‹¤)
         2. ê°ê° INSERT ì¿¼ë¦¬ë¥¼ ë‘ ë²ˆ ë‚ ë¦°ë‹¤.

             â€‹	INSERT INTO ITEM ...

             â€‹	INSERT INTO ALBUM ...

             
     2. ì¡°íšŒ : Album album = jpa.find(Album.class, albumId);

         - Itemê³¼ Album Joiní•´ì„œ ê²°ê³¼ ë°˜í™˜

         

      - ì—°ê´€ê´€ê³„ ì €ì¥ 

     member.setTeam(team);

     jpa.persist(member);

     ğŸ‘‰ğŸ» memberì—ì„œ teamì˜ PKê°’ì„ êº¼ë‚´ ì™¸ë˜í‚¤ì— ìë™ìœ¼ë¡œ ì…‹íŒ…

     

      - ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰

     Member member = jpa.find(Member.class, memberId);

     Team team = member.getTeam();

     ğŸ‘‰ğŸ» jpaë¥¼ í†µí•´ member ì •ë³´ë¥¼ ê°€ì ¸ì™€ member.getTeam()ë¥¼ í•˜ë©´ í•´ë‹¹ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
